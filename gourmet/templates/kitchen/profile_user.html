{% extends 'kitchen/base.html' %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static "kitchen/profile.css" %}">
<div class="content-profile-page">
 <div class="profile-user-page card1">
  <div class="img-user-profile">
		{% if user_cover %}
    <img class="profile-bgHome" src="{{MEDIA_URL}}{{user_cover}}"  data-toggle="modal" data-target="#coverMod"/>
		{% else %}
		<img class="profile-bgHome" data-toggle="modal" data-target="#coverMod" src="{% static "kitchen/default_cover.jpg" %}"/>
		{% endif %}
		{% if user_dp %}
    <img class="avatar" src="{{MEDIA_URL}}{{user_dp}}" data-toggle="modal" data-target="#dpModal">
		{% else %}
		<img class="avatar" src="{% static "kitchen/default_dp.png" %}" data-toggle="modal" data-target="#dpModal">
		{% endif %}
  </div>

  {% if is_self %}
  <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">Edit Profile</button>
{% endif %}
  <div class="user-profile-data">
    <h1>{{ user_name }}</h1>
    <p>User</p>
  </div>
  <div class="description-profile">Age:{{user_age}}</div><br>
	{% if user_about %}
  <div class="description-profile">About Me: {{user_about}}</div>
		{% endif %}
  <ul class="data-user">
    <li><a><strong>{{ recNo }}</strong><span>Saved Recipes</span></a></a></li>
  </ul>
</div>
</div>

<button type="button" class="btn" id="searchButton" data-toggle="modal" data-target="#mod2" >Search Recipe</button>

<div class="row">
  {% for rec_name, rec_hr, rec_min, rec_url, rec_img in recs %}
  <div class="col-xs-12 col-md-4 col-sm-6">
    <div class="card">
      <div class="image" onclick="location.href='{{rec_url}}'"><img src="{{MEDIA_URL}}{{rec_img}}" width=100% height="auto" class="image2 img-rounded"></div>
      <div class="description">
        <div>
          <h5 class="sub">Recipe Name</h5>
          <h4>{{ rec_name }}</h4>
        </div>
        <div class="timeDiv">
          <h5 class="sub">Time</h5>
          <h4>{{rec_hr}}h {{rec_min}}m</h4>
        </div>
      </div>
  </div>
</div>
{% endfor %}
</div>

{% if is_self %}
<!-- Edit Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-body">
        <form method="post" action="/detailsChange">
					{% csrf_token %}
          <h2 class="details"><strong>Edit Details</strong></h2><br>
            <div class="form-group">
              <label for="userName">Name</label>
              <input type="text" class="form-control" id="userName" placeholder="Your Name" required name="edit_name">
            </div>
            <div class="form-group">
              <label for="userEmail">Email address</label>
              <input type="email" class="form-control" id="userEmail" placeholder="{{user_email}}" required disabled>
            </div>
            <div class="form-group">
              <label for="userAge">Age</label>
              <input type="number" class="form-control" id="userAge" placeholder="Your Age" required name="edit_age">
            </div>
            <div class="form-group">
              <label for="selfDesc">About Me:</label>
              <textarea id="selfDesc" rows="6" cols="75" placeholder="Describe yourself" class="form-control" name="edit_about"></textarea>
            </div>
            <div class="form-group">
              <button type="submit" class="btn btn-success">Submit</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>



  <!-- modal for dp -->
  <div class="modal fade" id="dpModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-body">
          <form method="post" action="/dpChange" enctype='multipart/form-data'>
						{% csrf_token %}
            <div class="form-group">
              <label for="selDpUpload">Profile Image:</label>
              <div>
									{% if user_dp %}
											<img src="{{MEDIA_URL}}{{user_dp}}" class="thumbnail" id="dpUpload">
									{% else %}
											<img src="{%static "kitchen/default_dp.png" %}" class="thumbnail" id="dpUpload">
									{% endif %}
              </div>
              <input type="file" class="form-control" id="selDpUpload" accept="image/*" name="selDpUpload">
            </div>
            <div class="form-group">
              <button type="submit" class="btn btn-success">Save</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- modal for cover -->
  <div class="modal fade" id="coverMod" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-body">
          <form method="post" action="/coverChange" enctype='multipart/form-data'>
						{% csrf_token %}
            <div class="form-group">
              <label for="coverUpload">Cover Image:</label>
              <div>
								{% if user_cover %}
								<img src="{{MEDIA_URL}}{{user_cover}}" class="thumbnail" id="imgUpload">
								{% else %}
								<img src="{%static "kitchen/default_cover.jpg" %}" class="thumbnail" id="imgUpload" >
								{% endif %}
              </div>
              <input type="file" class="form-control" id="coverUpload" accept="image/*" name="coverUpload">
            </div>
            <button type="submit" class="btn btn-success">Save</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>


<!-- Modal for search -->
<div class="modal fade" id="mod2" tabindex="-1" role="dialog" aria-labelledby="myModal" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-body">
        <form>
          <div class="form-group">
            <h3>Search Recipe</h3>
          </div>
          <div class="form-group">
            <label for="ingredients" class="col-sm-2">Ingredients:</label>
          </div>
          <div class="form-group">
            <div class="col-sm-offset-2">
              <ul class="checkbox-grid">
                <li class="checkbox">
                  <input type="checkbox" id="ing1" name="ing1"/>
                  <label for="ing1">Ingredient 1</label>
                </li>
                <li class="checkbox">
                  <input type="checkbox" id="ing2" name="ing2"/>
                  <label for="ing2">Ingredient 2</label>
                </li>
                <li class="checkbox">
                  <input type="checkbox" id="ing3" name="ing3"/>
                  <label for="ing3">Ingredient 3</label>
                </li>
                <li class="checkbox">
                  <input type="checkbox" id="ing4" name="ing4"/>
                  <label for="ing4">Ingredient 4</label>
                </li>
                <li class="checkbox">
                  <input type="checkbox" id="ing5" name="ing5"/>
                  <label for="ing5">Ingredient 5</label>
                </li>
                <li class="checkbox">
                  <input type="checkbox" id="ing6" name="ing6"/>
                  <label for="ing6">Ingredient 6</label>
                </li>
                <li class="checkbox">
                  <input type="checkbox" id="ing7" name="ing7"/>
                  <label for="ing7">Ingredient 7</label>
                </li>
                <li class="checkbox">
                  <input type="checkbox" id="ing8" name="ing8"/>
                  <label for="ing8">Ingredient 8</label>
                </li>
                <li class="checkbox">
                  <input type="checkbox" id="ing9" name="ing9"/>
                  <label for="ing9">Ingredient 9</label>
                </li>
                <li class="checkbox">
                  <input type="checkbox" id="ing10" name="ing10"/>
                  <label for="ing10">Ingredient 10</label>
                </li>
                <li class="checkbox">
                  <input type="checkbox" id="ing11" name="ing11"/>
                  <label for="ing11">Ingredient 11</label>
                </li>
                <li class="checkbox">
                  <input type="checkbox" id="ing12" name="ing12"/>
                  <label for="ing12">Ingredient 12</label>
                </li>
                <li class="checkbox">
                  <input type="checkbox" id="ing13" name="ing13"/>
                  <label for="ing13">Ingredient 13</label>
                </li>
                <li class="checkbox">
                  <input type="checkbox" id="ing14" name="ing14"/>
                  <label for="ing14">Ingredient 14</label>
                </li>
                <li class="checkbox">
                  <input type="checkbox" id="ing15" name="ing15"/>
                  <label for="ing15">Ingredient 15</label>
                </li>
                <li class="checkbox">
                  <input type="checkbox" id="ing16" name="ing16"/>
                  <label for="ing16">Ingredient 16</label>
                </li>
              </ul>
            </div>
          </div>
          <div class="form-group">
              <button type="submit" class="btn btn-success">Search</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
{% endif %}



<script type="text/javascript">
  $("#userName").val("{{user_name}}");
  $("#userAge").val({{user_age}});
  $("#userEmail").val("{{user_email}}");
	{% if user_about %}
	  $("#selfDesc").val("{{user_about}}");
	{% endif %}
  $("#coverUpload").change(function(e) {
    for (var i = 0; i < e.originalEvent.srcElement.files.length; i++) {
      var file = e.originalEvent.srcElement.files[i];
      var reader = new FileReader();
      reader.onloadend = function() {
        $("#imgUpload").attr("src",reader.result);
      }
      reader.readAsDataURL(file);
    }
  });

  $("#selDpUpload").change(function(e) {
		console.log("DP something");
    for (var i = 0; i < e.originalEvent.srcElement.files.length; i++) {
      var file = e.originalEvent.srcElement.files[i];
      var reader = new FileReader();
      reader.onloadend = function() {
        $("#dpUpload").attr("src",reader.result);
      }
      reader.readAsDataURL(file);
    }
  });

</script>
{% endblock %}
